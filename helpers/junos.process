# Archivist - network device config archiver
#
# this is a perl script for post-processing downloaded Juniper JUNOS config file 
# in short - load, filter as you wish, and save to the same filename
#

$conf_file=$ARGV[0];

open(DAT, $conf_file);
@conf_text=<DAT>;
close(DAT);
open(DAT, '>'.$conf_file);  # rewrite downloaded config file

$line = 0;

foreach $confline (@conf_text)
 {

   # remove some unneeded lines from the config file
   # you can add something here to be filtered out from the archived JUNOS config
   
   if(($confline=~/show configuration/) ||   
      ($confline=~/Last commit/) ||
      ($confline=~/^\r$/) ||                   # various kinds of empty lines
      ($confline=~/^$/) ||                     #
      ($confline=~/^([^>]+>)/) )               # basic JUNOS prompt 
    {next;} 

   else {print DAT $confline;}
   $line++;
 }

print DAT "\n";

close(DAT);

undef @conf_text;

# end
